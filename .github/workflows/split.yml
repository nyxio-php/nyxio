name: 'Update'

on:
  push:
    branches: [ main ]
    tags: '*'

jobs:
  split:
    runs-on: ubuntu-latest

    strategy:
      fail-fast: false
      matrix:
        include:
          - path: 'Config'
            repo: 'config'

          - path: 'Container'
            repo: 'config'

          - path: 'Contract'
            repo: 'contract'

          - path: 'Event'
            repo: 'event'

          - path: 'Helper'
            repo: 'helper'

          - path: 'Http'
            repo: 'http'

          - path: 'Kernel'
            repo: 'Kernel'

          - path: 'Provider'
            repo: 'Provider'

          - path: 'Routing'
            repo: 'routing'

          - path: 'Server'
            repo: 'server'

          - path: 'Validation'
            repo: 'validation'

    steps:
      - uses: actions/checkout@v2
      - uses: "symplify/monorepo-split-github-action@2.0"
        env:
          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }}
        with:
          package-directory: 'src/${{ matrix.path }}'
          split-repository-organization: 'nyxio-php'
          split-repository-name: '${{ matrix.repo }}'
          user-name: "${{ github.actor }}"
          user-email: "${{ github.actor }}@users.noreply.github.com"
